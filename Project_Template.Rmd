---
title: "Project_Template"
author: "Lauren Shohan, Jessalyn Chuang, Alex López"
output: html_document
editor_options: 
  chunk_output_type: console
---

\newpage
\tableofcontents 
\newpage
\listoftables 
\newpage
\listoffigures 
\newpage

```{r setup, include=FALSE}
# Set your working directory

# Load your packages
library(tidyverse); library(lubridate); library(sf); library(leaflet)
library(mapview); library(leafsync); library(rvest); library(dataRetrieval)
library(dplyr); library(knitr); library(corrplot)
library(here)
here()

# Set your ggplot theme


# Load datasets

#NC Counties 
NC_counties<- st_read(here('Data/Spatial/cb_2018_us_county_20m.shp')) %>% 
  filter(STATEFP == 37) %>% 
  rename(COUNTY = NAME)

#power plant data set
powerplants <- st_read('https://services1.arcgis.com/Hp6G80Pky0om7QvQ/arcgis/rest/services/Plants_gdb/FeatureServer/0/query?outFields=*&where=1%3D1&f=geojson') %>%
  filter(STATE == 'NC')

#power plant retirements
  #retirement_year contains all of the generators that retired in NC as of 
  #Oct 2024 from https://www.eia.gov/electricity/data/eia860m/
retirement_year <- read.csv(here('Data/retired_generators.csv')) %>% 
  filter(Plant.State == "NC") %>% 
  group_by(Plant.Name, Plant.ID, Retirement.Year) %>% 
  # Keep Retirement.Year as the first, latest unit retirement is considered
  #retirement year
  summarise(Retirement.Year = first(Retirement.Year),.groups = "drop")

#pm2.5 datasets
pm2.5_2013 <- read_csv(here('Data/EPA_PM2.5/EPA_PM25_NC2013.csv'))
pm2.5_2014 <- read_csv(here('Data/EPA_PM2.5/EPA_PM25_NC2014.csv')) 
pm2.5_2015 <- read_csv(here('Data/EPA_PM2.5/EPA_PM25_NC2015.csv')) 
pm2.5_2016 <- read_csv(here('Data/EPA_PM2.5/EPA_PM25_NC2016.csv')) 
pm2.5_2017 <- read_csv(here('Data/EPA_PM2.5/EPA_PM25_NC2017.csv')) 
pm2.5_2018 <- read_csv(here('Data/EPA_PM2.5/EPA_PM25_NC2018.csv')) 
pm2.5_2019 <- read_csv(here('Data/EPA_PM2.5/EPA_PM25_NC2019.csv')) 
pm2.5_2020 <- read_csv(here('Data/EPA_PM2.5/EPA_PM25_NC2020.csv')) 
pm2.5_2021 <- read_csv(here('Data/EPA_PM2.5/EPA_PM25_NC2021.csv')) 
pm2.5_2022 <- read_csv(here('Data/EPA_PM2.5/EPA_PM25_NC2022.csv')) 

#CDC datasets
  #wrangling 2014 data because 2014 gdb import does not work
SVI2014_csv <- read.csv(here('Data/Project_Data/NorthCarolina_county_2014.csv'), 
                        colClasses = c('FIPS' = 'factor'))
SVI2014_gdb <- NC_counties %>% 
  left_join(
    SVI2014_csv, 
    by = c("GEOID" = "FIPS") 
    )

SVI2016_gdb <- st_read(here('Data/Project_Data/SVI2016_NORTHCAROLINA_COUNTY.gdb'))
SVI2018_gdb <- st_read(here('Data/Project_Data/SVI2018_NORTHCAROLINA_COUNTY.gdb'))
SVI2020_gdb <- st_read(here('Data/Project_Data/SVI2020_NORTHCAROLINA_COUNTY.gdb'))
SVI2022_gdb <- st_read(here('Data/Project_Data/SVI2022_NORTHCAROLINA_COUNTY.gdb'))


```


# Rationale and Research Questions
   This study investigates particulate matter (PM 2.5) air quality data alongside four Social Vulnerability Index (SVI) metrics across North Carolina counties and visually compares their proximity against retired and operating Power Plant locations. Environmental justice is an ever-concerning issue in America, and with the sudden increase in electricity consumption from the rise of data centers, it is important as ever to make sure injustices are not overlooked. The origins of the environmental justice movement stem from Warren County, North Carolina when an Africa-American community was chosen to be the location of a hazardous waste landfill, sparking national conversations about systemic environmental inequities. This historical context is the reason North Carolina was chosen as the area of focus for this research.  

   The study focuses on coal-burning power plants in particular because they are a major source of air pollution, specifically the very dangerous pollutant PM 2.5. PM 2.5 from coal combustion is rich in sulfur dioxide, black carbon, and metals which can enter a human’s lungs and bloodstream leading to conditions such as cancer, asthma, and even premature death. The NIH estimated from a study that for every 1 μg/m3 increase in coal PM 2.5, mortality in the studied regions increased by 1.12%. Given North Carolina’s unsettling environmental justice history, we seek to explore the connections between coal-burning power plants, amounts of PM 2.5 air pollution, and social vulnerability indices to potentially reveal disparities in air quality and publlic health impacts.  

Possible Questions: 

1. Is there a correlation between PM 2.5 concentrations in North Carolina and the proximity of coal-burning power plants? 

    a. Does the air quality improve in counties with retired plants compared to areas with operating plants? 

2. Do counties with higher Social Vulnerability Indexes (SVI) have higher concentrations of PM 2.5? 

    a. Are there more coal-burning powerplants in these counties? 

    b. Are there more clean energy powerplants in lower SVI counties? 

3. Is there a three-way relationship between coal-burning power plants, SVI, and PM 2.5 concentrations in North Carolina? 


\newpage

# Dataset Information
This research consists of X different datasets: Power Plants, North Carolina Retired Generators, SVI Indexes, and Particulate Matter 2.5 Air Quality.  

  
Power Plants and Retired Generators:  
  The Power Plant data set was collected from the open data site of the Geospatial Management Office of the U.S. Department of Homeland Security. The shapefile was created for the Homeland Infrastructure Foundation-Level Database and the Energy modeling community at large. This data contains electric power plants around the United States including the following plant types: hydroelectric dams, fossil fuels (coal, natural gas, or oil), nuclear, solar, wind, geothermal, and biomass. The man classifications that are used in this study are plant name, state location of plant, status of plant (Operating or Retired), primary fuel of plant, and geographic location.  

  The GeoJSON option of this data was copied and pasted into R Studio to bring in this dataset. This research narrowed the scope down to plants located in North Carolina. Then, primary fuel was narrowed to narrow out the plants that would not produce PM 2.5. According to EPA’s EGrid information, the abbreviations of plant primary fuel’s that are found within this dataset represent the following: BIT (blast furnace gas), AB (agricultural byproduct), BLQ (black liquor), DFO (distillate fuel oil, light fuel oil, FO2, diesel oil), LFG (landfill gas), NG (natural gas), OBG (digester gas, methane, and other biomass gases), SLW (sludge waste), WDS (wood, wood waste solid), WH (waste heat), SUN (solar), WND (wind), WAT (water), MWH (electricity), and NUC (nuclear). These plants were broken up into four categories: BIT only plants, other relatively moderate PM producing plants (WDS, SLW, BLQ, AB, and DFO), very low PM producing plants (LFG, NG, OBG, and WH), and a combination of BIT plants and the moderately producing PM plants. This last data frame was filtered for operating status of either operating or retired. Then, a second data set was merged to the retired plants data frame to add the column of retirement years. This data set is from U.S. Energy Information Administration ( https://www.eia.gov/electricity/data/eia860m/ ) and contains all generators retired in North Carolina as of October 2024. This was merged into the retired plants data frame by Plant Code and Plant ID. 


Social Vulnerability Index: 

 

Particulate Matter: 

 

North Carolina Counties – May Not Need? 

 

```{r data.summary, echo = FALSE}
#table that summarizes data structure (variables, units, ranges and/or central
#tendencies, data source if multiple are used, etc.) - dont include code used 
#to generate the table

## POWERPLANT SUMMARY AND KABLE 
powerplants_summary <- data.frame(
  Variable = c('PLANT_CODE', 'NAME', 'STATE', 'STATUS', 'COUNTY', 'COUNTYFIPS',
               'PRIM_FUEL', 'LATITUDE', 'LONGITUDE'),
  Description = c('Power Plant Code ID', 'Name of Power Plant', 'State Plant is 
  Located', 'Operating Status of Plant', 'County Plant is Located', 'County 
  FIPS', 'Primary Fuel of Plant', 'Latitude of Plant', 'Longitude of Plant'),
  Units = c('Character', 'Character', 'Character', 'Character', 'Character',
            'Character', 'Character', 'Double-precision decimal number', 
            'Double-precision decimal number')
)

SVI_summary <- data.frame(
  Variable = c('FIPS', 'STATE', 'RPL_THEME1', 'RPL_THEME2', 'RPL_THEME3', 
               'RPL_THEME4','RPL_THEMES'),
  Description = c('County FIPS Code', 'State', 'Theme 1 Percentile Ranking', 
                  'Theme 2 Percentile Ranking', 'Theme 3 Percentile Ranking', 
                  'Theme 4 Percentile Ranking', 
                  'Overall Summary Ranking Variable'),
  Units = c('Character', 'Character', 'Double-precision decimal number', 
            'Double-precision decimal number', 'Double-precision decimal number',
            'Double-precision decimal number', 'Double-precision decimal number')
)

kable(powerplants_summary, caption = 'NC Power Plant Summary')
kable(SVI_summary, caption = 'SVI Data Summary')


```

\newpage

# Exploratory Analysis 

```{r PM2.5.visualization.data, include=FALSE}

#spatial visualization of 2013 PM2.5 data
pm2.5_sf_2013 <- pm2.5_2013 %>% 
  group_by(`Site ID`, County, `Site Latitude`, `Site Longitude`) %>% 
  summarize(
    meanPM = mean(`Daily Mean PM2.5 Concentration`,na.rm=T),
    maxPM = max(`Daily Mean PM2.5 Concentration`,na.rm=T)
    ) %>% 
  st_as_sf(coords = c('Site Longitude','Site Latitude'), crs=4269)

#2014 PM2.5 data
pm2.5_sf_2014 <- pm2.5_2014 %>% 
  group_by(`Site ID`, County, `Site Latitude`, `Site Longitude`) %>% 
  summarize(
    meanPM = mean(`Daily Mean PM2.5 Concentration`,na.rm=T),
    maxPM = max(`Daily Mean PM2.5 Concentration`,na.rm=T)
    ) %>% 
  st_as_sf(coords = c('Site Longitude','Site Latitude'), crs=4269)

#mapview(pm2.5_sf_2014, zcol = 'meanPM')

#2015 PM2.5 data
pm2.5_sf_2015 <- pm2.5_2015 %>% 
  group_by(`Site ID`, County, `Site Latitude`, `Site Longitude`) %>% 
  summarize(
    meanPM = mean(`Daily Mean PM2.5 Concentration`,na.rm=T),
    maxPM = max(`Daily Mean PM2.5 Concentration`,na.rm=T)
    ) %>% 
  st_as_sf(coords = c('Site Longitude','Site Latitude'), crs=4269)

#mapview(pm2.5_sf_2015, zcol = 'meanPM')

#2016 PM2.5 data
pm2.5_sf_2016 <- pm2.5_2016 %>% 
  group_by(`Site ID`, County, `Site Latitude`, `Site Longitude`) %>% 
  summarize(
    meanPM = mean(`Daily Mean PM2.5 Concentration`,na.rm=T),
    maxPM = max(`Daily Mean PM2.5 Concentration`,na.rm=T)
    ) %>% 
  st_as_sf(coords = c('Site Longitude','Site Latitude'), crs=4269)

#mapview(pm2.5_sf_2016, zcol = 'meanPM')

#2017 PM2.5 data
pm2.5_sf_2017 <- pm2.5_2017 %>% 
  group_by(`Site ID`, County, `Site Latitude`, `Site Longitude`) %>% 
  summarize(
    meanPM = mean(`Daily Mean PM2.5 Concentration`,na.rm=T),
    maxPM = max(`Daily Mean PM2.5 Concentration`,na.rm=T)
    ) %>% 
  st_as_sf(coords = c('Site Longitude','Site Latitude'), crs=4269)

#mapview(pm2.5_sf_2017, zcol = 'meanPM')

#2018 PM2.5 data
pm2.5_sf_2018 <- pm2.5_2018 %>% 
  group_by(`Site ID`, County, `Site Latitude`, `Site Longitude`) %>% 
  summarize(
    meanPM = mean(`Daily Mean PM2.5 Concentration`,na.rm=T),
    maxPM = max(`Daily Mean PM2.5 Concentration`,na.rm=T)
    ) %>% 
  st_as_sf(coords = c('Site Longitude','Site Latitude'), crs=4269)

#mapview(pm2.5_sf_2018, zcol = 'meanPM')

#2019 PM2.5 data
pm2.5_sf_2019 <- pm2.5_2019 %>% 
  group_by(`Site ID`, County, `Site Latitude`, `Site Longitude`) %>% 
  summarize(
    meanPM = mean(`Daily Mean PM2.5 Concentration`,na.rm=T),
    maxPM = max(`Daily Mean PM2.5 Concentration`,na.rm=T)
    ) %>% 
  st_as_sf(coords = c('Site Longitude','Site Latitude'), crs=4269)

#mapview(pm2.5_sf_2019, zcol = 'meanPM')

#2020 PM2.5 data
pm2.5_sf_2020 <- pm2.5_2020 %>% 
  group_by(`Site ID`, County, `Site Latitude`, `Site Longitude`) %>% 
  summarize(
    meanPM = mean(`Daily Mean PM2.5 Concentration`,na.rm=T),
    maxPM = max(`Daily Mean PM2.5 Concentration`,na.rm=T)
    ) %>% 
  st_as_sf(coords = c('Site Longitude','Site Latitude'), crs=4269)

#mapview(pm2.5_sf_2020, zcol = 'meanPM')

#2021 PM2.5 data
pm2.5_sf_2021 <- pm2.5_2021 %>% 
  group_by(`Site ID`, County, `Site Latitude`, `Site Longitude`) %>% 
  summarize(
    meanPM = mean(`Daily Mean PM2.5 Concentration`,na.rm=T),
    maxPM = max(`Daily Mean PM2.5 Concentration`,na.rm=T)
    ) %>% 
  st_as_sf(coords = c('Site Longitude','Site Latitude'), crs=4269)

#mapview(pm2.5_sf_2021, zcol = 'meanPM')

#2022 PM2.5 data
pm2.5_sf_2022 <- pm2.5_2022 %>% 
  group_by(`Site ID`, County, `Site Latitude`, `Site Longitude`) %>% 
  summarize(
    meanPM = mean(`Daily Mean PM2.5 Concentration`,na.rm=T),
    maxPM = max(`Daily Mean PM2.5 Concentration`,na.rm=T)
    ) %>% 
  st_as_sf(coords = c('Site Longitude','Site Latitude'), crs=4269)

#mapview(pm2.5_sf_2022, zcol = 'meanPM')

#finding the two-year average in order to do analysis with EJ data
#combine spatial data frames for the 2-year averages
pm2.5_sf_20132014 <- rbind(pm2.5_sf_2013, pm2.5_sf_2014)
pm2.5_sf_20152016 <- rbind(pm2.5_sf_2015, pm2.5_sf_2016)
pm2.5_sf_20172018 <- rbind(pm2.5_sf_2017, pm2.5_sf_2018)
pm2.5_sf_20192020 <- rbind(pm2.5_sf_2019, pm2.5_sf_2020)
pm2.5_sf_20212022 <- rbind(pm2.5_sf_2021, pm2.5_sf_2022)
```

```{r powerplant.visualization.data, include=FALSE}

### BIT POWER PLANTS
  #major producer of PM 2.5 -> 18 BIT power plants in NC! 
  #combo of three types: 
     #conventional steam coal, conventional steam coal/natural gas fired 
     #combustion turbine, and conventional steam coal/petroleum liquids
BITfuelpowerplants <- powerplants %>%
  filter(PRIM_FUEL == 'BIT')

#other relatively high PM 2.5 producing from non-coal options
  #WDS, SLW, BLQ, AB, DFO
HighPMfuelpowerplants <- powerplants %>%
  filter(PRIM_FUEL %in% c('WDS', 'SLW', 'BLQ', 'AB', 'DFO'))


#VERY low PM 2.5 emitting primary fuels, may be too small to even count
   #LFG, NG, OBG, WAT, WH
otherPMproducingfuelpowerplants <- powerplants %>%
  filter(PRIM_FUEL %in% c('LFG', 'NG', 'OBG', 'WH'))

#Combination of BIT plants and 5 other relatively moderate PM emitting types
BIT_and_High_powerplants <- powerplants %>%
  filter(PRIM_FUEL %in% c('BIT', 'WDS', 'SLW', 'BLQ', 'AB', 'DFO' ))

```

```{r powerplant.mapview, fig.cap='Mapview of NC Coal-burning Power Plants'}
#mapview of BIT powerplants with NC counties
mapview(
  BITfuelpowerplants,
  zcol = 'PRIM_FUEL') +
  mapview(NC_counties)
```

```{r powerplant.mapview2, fig.cap='Mapview of Top 6 PM Emitting Primary Fuel Power Plants in NC'}
#mapview of BIT and pmpowerplants with NC counties
mapview(BITfuelpowerplants,
  zcol = 'PRIM_FUEL') +
  mapview(HighPMfuelpowerplants,
          zcol = 'PRIM_FUEL') +
  mapview(NC_counties, col.region = 'grey') 
```

```{r powerplants.operating.or.retired.data, include=FALSE}
#operating vs filtered 
operating_plants <- BIT_and_High_powerplants %>% filter(STATUS == 'OP')
retired_plants <- BIT_and_High_powerplants %>% filter(STATUS == 'RE')

#Convert PLANT_CODE to integer in retired_plants
retired_plants <- retired_plants %>%
  mutate(PLANT_CODE = as.integer(PLANT_CODE)) 

#Perform the join, one plant ENKA is missing retirement year
retired_plants <- retired_plants %>%
  left_join(retirement_year, by = c("PLANT_CODE" = "Plant.ID")) %>% 
  filter(Retirement.Year >= 2013)

#grouping operating vs retired by counties for further anaylsis 
countycount_OP_plants <- operating_plants %>%
  group_by(COUNTY, COUNTYFIPS) %>%
  summarize(Number_of_Plants = n())

countycount_RE_plants <- retired_plants %>%
  group_by(COUNTY, COUNTYFIPS, Retirement.Year) %>%
  summarize(Number_of_Plants = n())
```

```{r powerplants.operating.or.retired.map, fig.cap= 'Operating and Retired NC Plants'}
mapview(operating_plants, zcol = "PRIM_FUEL", col.region = 'blue') +
  mapview(retired_plants, zcol = "PRIM_FUEL", col.region = 'red') +
  mapview(NC_counties, col.region = 'grey')

#can see alot of retired ones are BIT 
```

```{r CDC.data.wrangling, include = FALSE}

# Remove spatial information from SVI datasets
SVI2014_df <- SVI2014_gdb %>% st_drop_geometry() 
SVI2016_df <- SVI2016_gdb %>% st_drop_geometry()
SVI2018_df <- SVI2018_gdb %>% st_drop_geometry()
SVI2020_df <- SVI2020_gdb %>% st_drop_geometry()
SVI2022_df <- SVI2022_gdb %>% st_drop_geometry() 

#Renaming the GEOID column to FIPS to be able to join with other dataframes more 
#easily
SVI2014_df <- SVI2014_df %>%
  rename(FIPS = GEOID)

# Perform the joins on the selected columns for each of the themes to be able to 
#do GLM analysis for each theme
theme1 <- SVI2014_df %>%
  select(FIPS, RPL_THEME1) %>%
  inner_join(SVI2016_df %>% select(FIPS, RPL_THEME1), by = "FIPS") %>%
  inner_join(SVI2018_df %>% select(FIPS, RPL_THEME1), by = "FIPS") %>%
  inner_join(SVI2020_df %>% select(FIPS, RPL_THEME1), by = "FIPS") %>%
  inner_join(SVI2022_df %>% select(FIPS, RPL_THEME1), by = "FIPS")

colnames(theme1) <- c("FIPS", 2014, 2016, 2018, 2020, 2022)

theme2 <- SVI2014_df %>%
  select(FIPS, RPL_THEME1) %>%
  inner_join(SVI2016_df %>% select(FIPS, RPL_THEME2), by = "FIPS") %>%
  inner_join(SVI2018_df %>% select(FIPS, RPL_THEME2), by = "FIPS") %>%
  inner_join(SVI2020_df %>% select(FIPS, RPL_THEME2), by = "FIPS") %>%
  inner_join(SVI2022_df %>% select(FIPS, RPL_THEME2), by = "FIPS")

colnames(theme2) <- c("FIPS", 2014, 2016, 2018, 2020, 2022)

theme3 <- SVI2014_df %>%
  select(FIPS, RPL_THEME1) %>%
  inner_join(SVI2016_df %>% select(FIPS, RPL_THEME3), by = "FIPS") %>%
  inner_join(SVI2018_df %>% select(FIPS, RPL_THEME3), by = "FIPS") %>%
  inner_join(SVI2020_df %>% select(FIPS, RPL_THEME3), by = "FIPS") %>%
  inner_join(SVI2022_df %>% select(FIPS, RPL_THEME3), by = "FIPS")

colnames(theme3) <- c("FIPS", 2014, 2016, 2018, 2020, 2022)

theme4 <- SVI2014_df %>%
  select(FIPS, RPL_THEME1) %>%
  inner_join(SVI2016_df %>% select(FIPS, RPL_THEME4), by = "FIPS") %>%
  inner_join(SVI2018_df %>% select(FIPS, RPL_THEME4), by = "FIPS") %>%
  inner_join(SVI2020_df %>% select(FIPS, RPL_THEME4), by = "FIPS") %>%
  inner_join(SVI2022_df %>% select(FIPS, RPL_THEME4), by = "FIPS")

colnames(theme4) <- c("FIPS", 2014, 2016, 2018, 2020, 2022)

theme_agg <- SVI2014_df %>%
  select(FIPS, RPL_THEMES) %>%
  inner_join(SVI2016_df %>% select(FIPS, RPL_THEMES), by = "FIPS") %>%
  inner_join(SVI2018_df %>% select(FIPS, RPL_THEMES), by = "FIPS") %>%
  inner_join(SVI2020_df %>% select(FIPS, RPL_THEMES), by = "FIPS") %>%
  inner_join(SVI2022_df %>% select(FIPS, RPL_THEMES), by = "FIPS")

colnames(theme_agg) <- c("FIPS", 2014, 2016, 2018, 2020, 2022)
```

```{r visualizing data}

counties_view <- mapview(NC_counties, col.region = 'grey')

plants_view <- mapview(operating_plants, zcol = "PRIM_FUEL", col.region = 'blue') +
  mapview(retired_plants, zcol = "PRIM_FUEL", col.region = 'red')

#theme 1 visualization
map_t1_20132014 <- mapview(pm2.5_sf_20132014, zcol = "meanPM", col.regions = colorRampPalette(c("lightgreen", "green", "darkgreen"))) + 
  mapview(SVI2014_gdb, zcol = "RPL_THEME1", 
          col.regions = colorRampPalette(c("pink", "orange", "purple"))) + 
  counties_view + plants_view

map_t1_20152016 <- mapview(pm2.5_sf_20152016, zcol = "meanPM", col.regions = colorRampPalette(c("lightgreen", "green", "darkgreen"))) + 
  mapview(SVI2016_gdb, zcol = "RPL_THEME1", 
          col.regions = colorRampPalette(c("pink", "orange", "purple"))) + 
  counties_view + plants_view

map_t1_20172018 <- mapview(pm2.5_sf_20172018, zcol = "meanPM", col.regions = colorRampPalette(c("lightgreen", "green", "darkgreen"))) + 
  mapview(SVI2018_gdb, zcol = "RPL_THEME1", 
          col.regions = colorRampPalette(c("pink", "orange", "purple"))) + 
  counties_view + plants_view

map_t1_20192020 <- mapview(pm2.5_sf_20192020, zcol = "meanPM", col.regions = colorRampPalette(c("lightgreen", "green", "darkgreen"))) + 
  mapview(SVI2020_gdb, zcol = "RPL_THEME1", 
          col.regions = colorRampPalette(c("pink", "orange", "purple"))) + 
  counties_view + plants_view

map_t1_20212022 <- mapview(pm2.5_sf_20212022, zcol = "meanPM", col.regions = colorRampPalette(c("lightgreen", "green", "darkgreen"))) + 
  mapview(SVI2022_gdb, zcol = "RPL_THEME1", 
          col.regions = colorRampPalette(c("pink", "orange", "purple"))) + 
  counties_view + plants_view

# Synchronize and display the maps side by side
sync(map_t1_20132014, map_t1_20152016, map_t1_20172018, map_t1_20192020, map_t1_20212022)

#theme 2 visualization
map_t2_20132014 <- mapview(pm2.5_sf_20132014, zcol = "meanPM", col.regions = colorRampPalette(c("lightgreen", "green", "darkgreen"))) + 
  mapview(SVI2014_gdb, zcol = "RPL_THEME2", 
          col.regions = colorRampPalette(c("pink", "orange", "purple"))) + 
  counties_view + plants_view

map_t2_20152016 <- mapview(pm2.5_sf_20152016, zcol = "meanPM", col.regions = colorRampPalette(c("lightgreen", "green", "darkgreen"))) + 
  mapview(SVI2016_gdb, zcol = "RPL_THEME2", 
          col.regions = colorRampPalette(c("pink", "orange", "purple"))) + 
  counties_view + plants_view

map_t2_20172018 <- mapview(pm2.5_sf_20172018, zcol = "meanPM", col.regions = colorRampPalette(c("lightgreen", "green", "darkgreen"))) + 
  mapview(SVI2018_gdb, zcol = "RPL_THEME2", 
          col.regions = colorRampPalette(c("pink", "orange", "purple"))) + 
  counties_view + plants_view

map_t2_20192020 <- mapview(pm2.5_sf_20192020, zcol = "meanPM", col.regions = colorRampPalette(c("lightgreen", "green", "darkgreen"))) + 
  mapview(SVI2020_gdb, zcol = "RPL_THEME2", 
          col.regions = colorRampPalette(c("pink", "orange", "purple"))) + 
  counties_view + plants_view

map_t2_20212022 <- mapview(pm2.5_sf_20212022, zcol = "meanPM", col.regions = colorRampPalette(c("lightgreen", "green", "darkgreen"))) + 
  mapview(SVI2022_gdb, zcol = "RPL_THEME2", 
          col.regions = colorRampPalette(c("pink", "orange", "purple"))) + 
  counties_view + plants_view

# Synchronize and display the maps side by side
sync(map_t2_20132014, map_t2_20152016, map_t2_20172018, map_t2_20192020, map_t2_20212022)

#theme 3 visualization
map_t3_20132014 <- mapview(pm2.5_sf_20132014, zcol = "meanPM", col.regions = colorRampPalette(c("lightgreen", "green", "darkgreen"))) + 
  mapview(SVI2014_gdb, zcol = "RPL_THEME3", 
          col.regions = colorRampPalette(c("pink", "orange", "purple"))) + 
  counties_view + plants_view

map_t3_20152016 <- mapview(pm2.5_sf_20152016, zcol = "meanPM", col.regions = colorRampPalette(c("lightgreen", "green", "darkgreen"))) + 
  mapview(SVI2016_gdb, zcol = "RPL_THEME3", 
          col.regions = colorRampPalette(c("pink", "orange", "purple"))) + 
  counties_view + plants_view

map_t3_20172018 <- mapview(pm2.5_sf_20172018, zcol = "meanPM", col.regions = colorRampPalette(c("lightgreen", "green", "darkgreen"))) + 
  mapview(SVI2018_gdb, zcol = "RPL_THEME3", 
          col.regions = colorRampPalette(c("pink", "orange", "purple"))) + 
  counties_view + plants_view

map_t3_20192020 <- mapview(pm2.5_sf_20192020, zcol = "meanPM", col.regions = colorRampPalette(c("lightgreen", "green", "darkgreen"))) + 
  mapview(SVI2020_gdb, zcol = "RPL_THEME3", 
          col.regions = colorRampPalette(c("pink", "orange", "purple"))) + 
  counties_view + plants_view

map_t3_20212022 <- mapview(pm2.5_sf_20212022, zcol = "meanPM", col.regions = colorRampPalette(c("lightgreen", "green", "darkgreen"))) + 
  mapview(SVI2022_gdb, zcol = "RPL_THEME3", 
          col.regions = colorRampPalette(c("pink", "orange", "purple"))) + 
  counties_view + plants_view

# Synchronize and display the maps side by side
sync(map_t3_20132014, map_t3_20152016, map_t3_20172018, map_t3_20192020, map_t3_20212022)

#theme 4 visualization
map_t4_20132014 <- mapview(pm2.5_sf_20132014, zcol = "meanPM", col.regions = colorRampPalette(c("lightgreen", "green", "darkgreen"))) + 
  mapview(SVI2014_gdb, zcol = "RPL_THEME4", 
          col.regions = colorRampPalette(c("pink", "orange", "purple"))) + 
  counties_view + plants_view

map_t4_20152016 <- mapview(pm2.5_sf_20152016, zcol = "meanPM", col.regions = colorRampPalette(c("lightgreen", "green", "darkgreen"))) + 
  mapview(SVI2016_gdb, zcol = "RPL_THEME4", 
          col.regions = colorRampPalette(c("pink", "orange", "purple"))) + 
  counties_view + plants_view

map_t4_20172018 <- mapview(pm2.5_sf_20172018, zcol = "meanPM", col.regions = colorRampPalette(c("lightgreen", "green", "darkgreen"))) + 
  mapview(SVI2018_gdb, zcol = "RPL_THEME4", 
          col.regions = colorRampPalette(c("pink", "orange", "purple"))) + 
  counties_view + plants_view

map_t4_20192020 <- mapview(pm2.5_sf_20192020, zcol = "meanPM", col.regions = colorRampPalette(c("lightgreen", "green", "darkgreen"))) + 
  mapview(SVI2020_gdb, zcol = "RPL_THEME4", 
          col.regions = colorRampPalette(c("pink", "orange", "purple"))) + 
  counties_view + plants_view

map_t4_20212022 <- mapview(pm2.5_sf_20212022, zcol = "meanPM", col.regions = colorRampPalette(c("lightgreen", "green", "darkgreen"))) + 
  mapview(SVI2022_gdb, zcol = "RPL_THEME4", 
          col.regions = colorRampPalette(c("pink", "orange", "purple"))) + 
  counties_view + plants_view

# Synchronize and display the maps side by side
sync(map_t4_20132014, map_t4_20152016, map_t4_20172018, map_t4_20192020, map_t4_20212022)

#Overall percentile visualization
map_overall_20132014 <- mapview(pm2.5_sf_20132014, zcol = "meanPM", col.regions = colorRampPalette(c("lightgreen", "green", "darkgreen"))) + 
  mapview(SVI2014_gdb, zcol = "RPL_THEMES", 
          col.regions = colorRampPalette(c("pink", "orange", "purple"))) + 
  counties_view + plants_view

map_overall_20152016 <- mapview(pm2.5_sf_20152016, zcol = "meanPM", col.regions = colorRampPalette(c("lightgreen", "green", "darkgreen"))) + 
  mapview(SVI2016_gdb, zcol = "RPL_THEMES", 
          col.regions = colorRampPalette(c("pink", "orange", "purple"))) + 
  counties_view + plants_view

map_overall_20172018 <- mapview(pm2.5_sf_20172018, zcol = "meanPM", col.regions = colorRampPalette(c("lightgreen", "green", "darkgreen"))) + 
  mapview(SVI2018_gdb, zcol = "RPL_THEMES", 
          col.regions = colorRampPalette(c("pink", "orange", "purple"))) + 
  counties_view + plants_view

map_overall_20192020 <- mapview(pm2.5_sf_20192020, zcol = "meanPM", col.regions = colorRampPalette(c("lightgreen", "green", "darkgreen"))) + 
  mapview(SVI2020_gdb, zcol = "RPL_THEMES", 
          col.regions = colorRampPalette(c("pink", "orange", "purple"))) + 
  counties_view + plants_view

map_overall_20212022 <- mapview(pm2.5_sf_20212022, zcol = "meanPM", col.regions = colorRampPalette(c("lightgreen", "green", "darkgreen"))) + 
  mapview(SVI2022_gdb, zcol = "RPL_THEMES", 
          col.regions = colorRampPalette(c("pink", "orange", "purple"))) + 
  counties_view + plants_view

# Synchronize and display the maps side by side
sync(map_overall_20132014, map_overall_20152016, map_overall_20172018, map_overall_20192020, map_overall_20212022)
```

\newpage

# Analysis



## Question 1: <insert specific question here and add additional subsections for additional questions below, if needed>

## Question 2: 




\newpage

# Summary and Conclusions


\newpage

# References
1.  "Environmental Justice History." U.S. Department of Energy, www.energy.gov/lm/environmental-justice-history.

2. Doctrow, Brian. "Deaths associated with pollution from coal power plants." National Institutes of Health, 12 Dec. 2023, www.nih.gov/news-events/nih-research-matters/deaths-associated-pollution-coal-power-plants.

3. "EGrid ." Environmental Protection Agency, www.epa.gov/egrid/code-lookup.


